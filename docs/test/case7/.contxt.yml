config:
  sequencially: false
  coloroff: true
task:
  - id: base
    stopreasons:
      onerror: true
    options:
      displaycmd: true
      format: "thread-test-main:\t[%s]\n"
    script:
      - echo 'main'
      - echo 'run-cmd'
      - echo 'done-main'
    listener:
      - trigger:
          onoutContains:
            - "run-cmd"
        action:
          target: sub
  - id: sub
    stopreasons:
      onerror: true
    options:
      displaycmd: true
      # have to be set or the whole test will fail 
      # because of this error
      ignoreCmdError: true
      format: "thread-test-sub:\t[%s]\n"
    script:
      - echo 'sub-start'
      - echo 'next-should-fail'
      - a-unknown-command
      - echo 'sub-end'